## 数据索引

### 索引类型

#### 聚集索引 

聚集索引就是将数据和索引都放到一起的一种索引结构。聚集索引的B+Tree上既有索引，又由数据，索引的逻辑顺序直接决定了数据的物理存储顺序。常见的primary key就是聚集索引。聚集索引的叶子节点存放的是表中所有行数据的记录信息。在innodb存储引擎中，如果没有显式的指定primary key，就会选着第一个不包含null的unique key 作为主键索引。如果没有unique key，就生成一个6字节的rowid作为主键。

#### 普通索引

普通索引是将数据和索引分开的一种索引结构。B+Tree的叶子节点上存放的是数据存放的物理地址。在检索时，需要先找到叶子节点的主键，在根据主键查找行数据。普通索引中会包含主键索引的值，如：给表中的name创建索引，其实是（id,name）这样的索引结构

#### 主键索引

主键索引其实就是聚集索引。在innodb引擎中，每个表都必须要有一个主键索引，可以由表中的一个或者多个字段组成。

主键索引必须满足以下条件：

1. 主键值必须全局唯一
2. 不能包含null值
3. 最好用自增列所为主键，可以保证数据插入的时候是顺序写。

#### 唯一索引

唯一索引是约束条件的一种，可以由单个或者多个列组成。在插入数据时，数据库会先判断当前数据是否已经存在。在大批量恢复导入数据的时候，可以先关闭唯一索引校验（`unique_checks` 属性控制），提高插入效率。

唯一索引和主键索引的区别在于唯一索引允许有null值，且一个表中可以有多个唯一索引。主键索引不允许有null值，且一个表中只能有一个。

#### 覆盖索引

只需要通过索引就可以查找到想要的数据，不需要回表查询，减少io次数的索引，成为覆盖索引。如：在表中有（id，name）两个字段，且name字段创建普通索引。因为在mysql中的普通索引会自带主键索引，当执行`select name from table where id = #{id}` 的时候，可以在B+Tree索引上找到结果数据，就不需要去磁盘查找。

> select * from table where id  = #{id} 不会使用到覆盖索引

#### 前缀索引

在varchar、text、blog等字符类型中，如果对整个字段添加索引，会导致数据量很大，这个时候就需要创建前缀索引。前缀索引是针对字符类型字段的前几个字符创建索引的一种方式。这样创建是索引更小，查找更快。

在order by 和group by中使用前缀索引，索引并不会生效。前缀索引也不会发生索引覆盖。

#### 哈希索引

哈希索引是利用hash算法，将键值对转换成哈希值，实现O(1)效率的查找。哈希索引只能实现等值查找，不能用来排序、模糊、范围查询等。

#### 联合索引

对表中的多个字段添加普通索引的方式，成为联合索引。联合索引的查询必须满足“左前缀“原则

###  索引优化

